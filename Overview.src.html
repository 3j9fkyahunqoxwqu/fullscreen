<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en-US">
 <head>
  <meta http-equiv=content-type content=text/html;charset=UTF-8>
  <title>Fullscreen</title>
  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em 1em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   pre code { color:inherit; background:transparent }
   pre.css { border: solid 0.0625em; background: #FFFFEE; color: black; padding: 0.5em 1em; }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid #f00 }
   p.XXX::before { content:"Issue: " }
   dl.switch { padding-left:2em }
   dl.switch > dt { text-indent:-1.5em }
   dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
   dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
   dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
   dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
   dl.domintro dd p { margin: 0.5em 0; }
   dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   dfn { font-weight:bold; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
   hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
   table { border-collapse:collapse; border-style:hidden hidden none hidden }
   table thead { border-bottom:solid }
   table tbody th:first-child { border-left:solid }
   table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }

   .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
   .warning p:first-child { margin-top: 0; }
   .warning p:last-child { margin-bottom: 0; }
   .warning:before { font-style: normal; }
   p.warning:before { content: '\26A0 Warning! '; }

   @media print {
     [data-anolis-spec]::after { content:"[" attr(data-anolis-spec) "]"; font-size:.6em; vertical-align:super; text-transform:uppercase }
   }
  </style>
  <link rel=stylesheet href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS]">
 </head>
 <body>

<div class=head>
<!--logo-->
 <h1>Fullscreen</h1>
 <h2 class="no-num no-toc">[LONGSTATUS] [DATE: 01 Jan 1901]</h2>

 <dl>
  <dt>This Version:
  <dd class=dontpublish><a href="http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html</a>
  <dd class=publish><a href="[VERSION]">[VERSION]</a>

  <dt class=publish>Latest Version:
  <dd class=publish><a href="[LATEST]">[LATEST]</a>

  <dt class=publish>Latest Editor Draft:
  <dd class=publish><a href="http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/fullscreen/raw-file/tip/Overview.html</a>

  <!--
  <dt>Previous Versions:
  -->

  <dt>Editors:
  <dd class="vcard h-card"><a class="url u-url fn p-fn" lang="nl" href="http://annevankesteren.nl/">Anne van Kesteren</a>
    (<a class="org h-org" href="http://www.opera.com/">Opera Software ASA</a>)
    &lt;<a class="email u-email" href="mailto:annevk@opera.com">annevk@opera.com</a>>

  <dd class="vcard h-card"><a class="url u-url fn p-fn" lang="tr" href="http://tantek.com/">Tantek Ã‡elik</a>
    (<a class="org h-org" href="http://www.mozilla.org/">Mozilla Foundation</a>)
    &lt;<a class="email u-email" href="mailto:tantek@cs.stanford.edu">tantek@cs.stanford.edu</a>>
 </dl>

<p><a rel="license" href="http://creativecommons.org/publicdomain/zero/1.0/"><img src="http://i.creativecommons.org/p/zero/1.0/80x15.png" alt="CC0"></a>
To the extent possible under law, the editors have waived all copyright and
related or neighboring rights to this work. In addition, as of
[DATE: 01 Jan 1901], the editors have made this specification available
under the
<a rel="license"
href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0">Open Web Foundation Agreement Version 1.0</a>,
which is available at
http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
<!-- XXX
When published on W3C TR, the following paragraph applies as well.
-->
<!-- XXX copyright-->
</div>

<hr>

<h2 class="no-num no-toc">Abstract</h2>

<p>The Fullscreen specification defines a way for an
<span data-anolis-spec=dom title=concept-element>element</span> to be
displayed fullscreen programmatically.</p>


<h2 class="no-num no-toc" id=sotd>Status of this Document</h2>
<p>Whatever.



<h2 class="no-num no-toc">Table of Contents</h2>
<!--toc-->



<h2>Conformance</h2>
<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this specification are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification. <span
data-anolis-ref>RFC2119</span>


<h2>Terminology</h2>

<p>Most terminology used in this specification is from the DOM and HTML.
<span data-anolis-ref>DOM</span>
<span data-anolis-ref>HTML</span>

<p>The term <dfn>context object</dfn> means the object on which the method
or attribute being discussed was called. When the
<span>context object</span> is unambiguous, the term can be omitted.

<p>A <span data-anolis-spec=html>browsing context</span> <var title>A</var>
is called a <dfn>descendant browsing context</dfn> of a
<span data-anolis-spec=html>browsing context</span> <var title>B</var> if
and only if <var title>B</var> is an
<span data-anolis-spec=html>ancestor browsing context</span> of
<var title>A</var>.


<h2>Model</h2>

<p>The <span data-anolis-spec=html>task source</span> used by this
specification is the
<span data-anolis-spec=html>user interaction task source</span>.

<p>All <span data-anolis-spec=dom title=concept-document>documents</span>
have an associated <dfn>fullscreen enabled flag</dfn> and
<dfn>fullscreen element</dfn>.

<p>Unless otherwise stated the <span>fullscreen enabled flag</span> is unset
and the <span>fullscreen element</span> is null.

<p class=note>HTML defines under what conditions the
<span>fullscreen enabled flag</span> is set.
<span data-anolis-ref>HTML</span>
<!--
  not set for <iframe>, createDocument();
  set for <iframe allowfullscreen>
-->

<p>If the <span>fullscreen element</span> is removed from the
<span data-anolis-spec=dom title=concept-document>document</span>, act as if
the <code title=dom-Document-exitFullscreen>exitFullscreen()</code> method
was invoked on the
<span data-anolis-spec=html>top-level browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>document</span>.
<!-- XXX reference DOM mutation -->


<h2>API</h2>

<p class=XXX>Currently the API restricts to one invocation of requestFullscreen() per top-level browsing context. We are going to remove that restriction in favor of a stack-based approach.

<pre class=idl>partial interface <span data-anolis-spec=dom>Element</span> {
  void <span title=dom-Element-requestFullscreen>requestFullscreen</span>();
};

partial interface <span data-anolis-spec=dom>Document</span> {
  readonly attribute boolean <span title=dom-Document-fullscreenEnabled>fullscreenEnabled</span>;
  readonly attribute <span data-anolis-spec=dom>Element</span> <span title=dom-Document-fullscreenElement>fullscreenElement</span>;

  void <span title=dom-Document-exitFullscreen>exitFullscreen</span>();
};</pre>

<p>The
<dfn title=dom-Element-requestFullscreen><code>requestFullscreen()</code></dfn>
method must run these steps:

<ol>
 <li>
  <p>If any of the following conditions are true, terminate these steps and
  <span data-anolis-spec=html>queue a task</span> to
  <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
  named <code>fullscreenerror</code> with its
  <code title=dom-Event-bubbles>bubbles</code> attribute set to true on the
  <span>context object</span>:

  <ul>
   <li><p>The <span>context object</span> is not
   <span data-anolis-spec=dom>in a document</span>.

   <li><p>The <span>context object</span>'s
   <span data-anolis-spec=dom title=concept-node-document>node document</span>, or an
   <span data-anolis-spec=html>ancestor browsing context</span>'s
   <span data-anolis-spec=dom title=concept-document>document</span> does
   not have the <span>fullscreen enabled flag</span> set.

   <li><p>The <span>context object</span>'s
   <span data-anolis-spec=dom title=concept-node-document>node document</span>, or an
   <span data-anolis-spec=html>ancestor browsing context</span>'s
   <span data-anolis-spec=dom title=concept-document>document</span> has a
   non-null <span>fullscreen element</span>.

   <li><p>This algorithm is not
   <span data-anolis-spec=html>allowed to show a pop-up</span>.

   <li><p>There is a previously-established user preference, security risk,
   or platform limitation.
  </ul>

 <li><p>Let <var title>doc</var> be <var title>element</var>'s
 <span data-anolis-spec=dom title=concept-node-document>node document</span>.

 <li><p>Let <var title>docs</var> be all <var title>doc</var>'s
 <span data-anolis-spec=html>ancestor browsing context</span>'s
 <span data-anolis-spec=dom title=concept-document>documents</span> (if any)
 and <var title>doc</var>.

 <li>
  <p>For each <var title>document</var> in <var title>docs</var>, run these
  substeps:

  <ol>
   <li><p>Let <var title>following document</var> be the
   <span data-anolis-spec=dom title=concept-document>document</span> after
   <var title>document</var> in <var title>docs</var>, or null if there is
   no such document.

   <li><p>If <var title>following document</var> is null, set
   <var title>document</var>'s <span>fullscreen element</span> to the
   <span>context object</span>,
   <span data-anolis-spec=html>queue a task</span> to
   <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
   named <code>fullscreenchange</code> with its
   <code title=dom-Event-bubbles>bubbles</code> attribute set to true on the
   <span>context object</span>.

   <li><p>Otherwise, set <var title>document</var>'s
   <span>fullscreen element</span> to <var title>following document</var>'s
   <span data-anolis-spec=html>browsing context container</span> and
   <span data-anolis-spec=html>queue a task</span> to
   <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
   named <code>fullscreenchange</code> with its
   <code title=dom-Event-bubbles>bubbles</code> attribute set to true on
   <var title>document</var>.
  </ol>

 <li><p>Return, and run the remaining steps asynchronously.

 <li><p>Optionally, perform some animation.

 <li><p>Optionally, display a message indicating how the user can exit
 displaying the <span>context object</span> fullscreen.
</ol>

<p>The
<dfn title=dom-Document-fullscreenEnabled><code>fullscreenEnabled</code></dfn>
attribute must return true if the <span>context object</span> and all
<span data-anolis-spec=html>ancestor browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>documents</span> have
their <span>fullscreen enabled flag</span> set and the
<span data-anolis-spec=html>top-level browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>document</span>'s
<span>fullscreen element</span> is null, or false otherwise.

<p>The <dfn title=dom-Document-fullscreenElement><code>fullscreenElement</code></dfn>
attribute must return the <span>context object</span>'s
<span>fullscreen element</span>.

<p>The
<dfn title=dom-Document-exitFullscreen><code>exitFullscreen()</code></dfn>
method must run these steps:

<ol>
 <li><p>If the <span>context object</span> does not have a non-null
 <span>fullscreen element</span>, terminate these steps.

 <li><p>Let <var title>docs</var> be all the <span>context object</span>'s
 <span data-anolis-spec=html>descendant browsing context</span>'s
 <span data-anolis-spec=dom title=concept-document>documents</span> with a
 non-null <span>fullscreen element</span> (if any),
 the <span>context object</span>, and all the
 <span>context object</span>'s
 <span data-anolis-spec=html>ancestor browsing context</span>'s
 <span data-anolis-spec=dom title=concept-document>documents</span>.

 <li><p>For each <var title>document</var> in <var title>docs</var>, set
 <var title>document</var>'s <span>fullscreen element</span> to null and
 <span data-anolis-spec=html>queue a task</span> to
 <span data-anolis-spec=dom title=concept-event-fire>fire an event</span>
 named <code>fullscreenchange</code> with its
 <code title=dom-Event-bubbles>bubbles</code> attribute set to true on the
 <var title>document</var>.

 <li><p>Return, and run the remaining steps asynchronously.

 <li><p>Optionally, perform some animation.
</ol>

<h2>UI</h2>

<p>User agents are encouraged to implement native media fullscreen controls
in terms of
<code title=dom-Element-requestFullscreen>requestFullscreen()</code> and
<code title=dom-Document-exitFullscreen>exitFullscreen()</code>.

<p>If the end user instructs the user agent to end a fullscreen session
initiated via
<code title=dom-Element-requestFullscreen>requestFullscreen()</code>, act as
if <code title=dom-Document-exitFullscreen>exitFullscreen()</code> was
invoked on the
<span data-anolis-spec=html>top-level browsing context</span>'s
<span data-anolis-spec=dom title=concept-document>document</span>.

<h2>Selectors (<code title>:fullscreen</code> and <code title>:fullscreen-ancestor</code>)</h2>

<p>The <dfn title=css-pc-fullscreen><code>:fullscreen</code></dfn>
pseudo-class must match the <span>fullscreen element</span> (if any).

<p>The
<dfn title=css-pc-fullscreen-ancestor><code>:fullscreen-ancestor</code></dfn>
pseudo-class must match all
<span data-anolis-spec=dom title=concept-element>elements</span> that are
<span data-anolis-spec=dom title=concept-tree-ancestor>ancestors</span> of
the <span>fullscreen element</span> (if any).

<h2>Rendering</h2>

<p>This section is to be interpreted equivalently to the Rendering section
of HTML.
<span data-anolis-ref>HTML</span>

<p>However, unlike the HTML specification, the CSS rules given below are to
be put between "author normal declarations" and
"author important declarations" in the cascading order.
<span data-anolis-ref>CSS</span>

<pre class=css>:fullscreen {
  position:fixed;
  top:0;
  left:0;
  right:0;
  bottom:0;
  z-index:2147483647;
  box-sizing:border-box;
  margin:0;
  width:100%;
  height:100%;
}
/* If there is a fullscreen element that is not the root then
   we should hide the viewport scrollbar. */
:fullscreen-ancestor:root {
  overflow:hidden;
}
:fullscreen-ancestor {
  /* Ancestors of a fullscreen element should not induce stacking contexts
     that would prevent the fullscreen element from being on top. */
  z-index:auto;
  /* Ancestors of a fullscreen element should not be partially transparent,
     since that would apply to the fullscreen element and make the page visible
     behind it. It would also create a pseudo-stacking-context that would let content
     draw on top of the fullscreen element. */
  opacity:1;
  /* Ancestors of a fullscreen element should not apply SVG masking, clipping, or
     filtering, since that would affect the fullscreen element and create a pseudo-
     stacking context. */
  mask:none;
  clip:auto;
  filter:none;
  transform:none;
  transition:none;
}</pre> <!-- XXX clean up comments at some point -->



<h2 class=no-num>References</h2>
<h3 class=no-num>Normative references</h3>
<div id=anolis-references-normative></div>


<!--<h3 class=no-num>Informative references</h3>
<div id=anolis-references-informative></div>-->



<h2 class=no-num>Acknowledgments</h2>

<p>Many thanks to Robert O'Callahan for designing the initial model and his
useful comments.</p>
<!-- https://wiki.mozilla.org/Gecko:FullScreenAPI -->

<p>Thanks to
Chris Pearce,
Darin Fisher,
Glenn Maynard,
Josh Soref, and
Rune Lillesveen

for their useful comments.</p>
